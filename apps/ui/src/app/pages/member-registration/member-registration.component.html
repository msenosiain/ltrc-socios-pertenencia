<div class="registration-container">
  <mat-card class="registration-card">
    <mat-card-header>
      <div class="header-content">
        <img src="logo-LosTordos.png" alt="Los Tordos Rugby Club" class="club-logo">
        <div class="header-text">
          <mat-card-title>Registro de Socio</mat-card-title>
          <mat-card-subtitle>Complete el formulario para registrarse como socio del club</mat-card-subtitle>
        </div>
      </div>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()">

        <!-- Member Data Section -->
        <section class="form-section">
          <h3>
            <mat-icon>person</mat-icon>
            Datos del Socio
          </h3>

          <div class="form-row">
            <mat-form-field appearance="outline">
              <mat-label>Nombre</mat-label>
              <input matInput formControlName="firstName" placeholder="Ingrese su nombre">
              <mat-error>{{ getErrorMessage('firstName') }}</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Apellido</mat-label>
              <input matInput formControlName="lastName" placeholder="Ingrese su apellido">
              <mat-error>{{ getErrorMessage('lastName') }}</mat-error>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline">
              <mat-label>Fecha de Nacimiento</mat-label>
              <input matInput
                     [matDatepicker]="picker"
                     formControlName="birthDate"
                     placeholder="DD/MM/AAAA"
                     [ltrcInputMask]="'date'">
              <mat-hint>Formato: DD/MM/AAAA</mat-hint>
              <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
              <mat-error>{{ getErrorMessage('birthDate') }}</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Número de DNI</mat-label>
              <input matInput formControlName="documentNumber" placeholder="12345678" maxlength="8">
              <mat-icon matSuffix>fingerprint</mat-icon>
              <mat-error>{{ getErrorMessage('documentNumber') }}</mat-error>
            </mat-form-field>
          </div>

          <div class="file-upload-section">
            <input
              type="file"
              id="documentImage"
              (change)="onFileSelected($event)"
              accept="image/*"
              hidden
              #fileInput>
            <button mat-stroked-button type="button" (click)="fileInput.click()" [class.file-error]="fileRequired">
              <mat-icon>upload</mat-icon>
              {{ selectedFileName || 'Subir foto del DNI *' }}
            </button>
            @if (fileRequired) {
              <mat-error class="file-error-message">La foto del DNI es obligatoria</mat-error>
            }
          </div>
        </section>

        <mat-divider></mat-divider>

        <!-- Card Holder Section -->
        <section class="form-section">
          <h3>
            <mat-icon>credit_card</mat-icon>
            Datos del Titular de la Tarjeta
          </h3>

          <mat-checkbox formControlName="sameAsMember" color="primary">
            El titular es el mismo que el socio
          </mat-checkbox>

          <div class="form-row">
            <mat-form-field appearance="outline">
              <mat-label>Nombre del Titular</mat-label>
              <input matInput formControlName="cardHolderFirstName" placeholder="Nombre del titular">
              <mat-error>{{ getErrorMessage('cardHolderFirstName') }}</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Apellido del Titular</mat-label>
              <input matInput formControlName="cardHolderLastName" placeholder="Apellido del titular">
              <mat-error>{{ getErrorMessage('cardHolderLastName') }}</mat-error>
            </mat-form-field>
          </div>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>DNI del Titular</mat-label>
            <input matInput formControlName="cardHolderDocumentNumber" placeholder="12345678" maxlength="8">
            <mat-error>{{ getErrorMessage('cardHolderDocumentNumber') }}</mat-error>
          </mat-form-field>

          <div class="form-row">
            <mat-form-field appearance="outline">
              <mat-label>Número de Tarjeta</mat-label>
              <input matInput
                     formControlName="creditCardNumber"
                     placeholder="1234-5678-9012-3456"
                     maxlength="19"
                     [ltrcInputMask]="'creditCard'">
              <mat-icon matSuffix>credit_card</mat-icon>
              <mat-error>{{ getErrorMessage('creditCardNumber') }}</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Vencimiento (MM/AA)</mat-label>
              <input matInput
                     formControlName="creditCardExpirationDate"
                     placeholder="MM/AA"
                     maxlength="5"
                     [ltrcInputMask]="'expiration'">
              <mat-icon matSuffix>event</mat-icon>
              <mat-error>{{ getErrorMessage('creditCardExpirationDate') }}</mat-error>
            </mat-form-field>
          </div>
        </section>

        <div class="form-actions">
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="isSubmitting"
            class="submit-button">
            @if (isSubmitting) {
              <mat-spinner diameter="20"></mat-spinner>
              Enviando...
            } @else {
              <ng-container>
                Registrar Socio
              </ng-container>
            }
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>

